%% Copernicus Publications Manuscript Preparation Template for LaTeX Submissions
%% ---------------------------------
%% This template should be used for copernicus.cls
%% The class file and some style files are bundled in the Copernicus Latex Package, which can be downloaded from the different journal webpages.
%% For further assistance please contact Copernicus Publications at: production@copernicus.org
%% https://publications.copernicus.org/for_authors/manuscript_preparation.html

%% Please use the following documentclass and journal abbreviations for preprints and final revised papers.

%% 2-column papers and preprints
\documentclass[hess, manuscript]{copernicus}

%\usepackage{graphics} % scalebox
\usepackage{booktabs} % toprule, bottomrule

%% Journal abbreviations (please use the same for preprints and final revised papers)

% Advances in Geosciences (adgeo)
% Advances in Radio Science (ars)
% Advances in Science and Research (asr)
% Advances in Statistical Climatology, Meteorology and Oceanography (ascmo)
% Aerosol Research (ar)
% Annales Geophysicae (angeo)
% Archives Animal Breeding (aab)
% Atmospheric Chemistry and Physics (acp)
% Atmospheric Measurement Techniques (amt)
% Biogeosciences (bg)
% Climate of the Past (cp)
% DEUQUA Special Publications (deuquasp)
% Earth Surface Dynamics (esurf)
% Earth System Dynamics (esd)
% Earth System Science Data (essd)
% E&G Quaternary Science Journal (egqsj)
% EGUsphere (egusphere) | This is only for EGUsphere preprints submitted without relation to an EGU journal.
% European Journal of Mineralogy (ejm)
% Fossil Record (fr)
% Geochronology (gchron)
% Geographica Helvetica (gh)
% Geoscience Communication (gc)
% Geoscientific Instrumentation, Methods and Data Systems (gi)
% Geoscientific Model Development (gmd)
% History of Geo- and Space Sciences (hgss)
% Hydrology and Earth System Sciences (hess)
% Journal of Bone and Joint Infection (jbji)
% Journal of Micropalaeontology (jm)
% Journal of Sensors and Sensor Systems (jsss)
% Magnetic Resonance (mr)
% Mechanical Sciences (ms)
% Natural Hazards and Earth System Sciences (nhess)
% Nonlinear Processes in Geophysics (npg)
% Ocean Science (os)
% Polarforschung - Journal of the German Society for Polar Research (polf)
% Primate Biology (pb)
% Proceedings of the International Association of Hydrological Sciences (piahs)
% Safety of Nuclear Waste Disposal (sand)
% Scientific Drilling (sd)
% SOIL (soil)
% Solid Earth (se)
% State of the Planet (sp)
% The Cryosphere (tc)
% Weather and Climate Dynamics (wcd)
% Web Ecology (we)
% Wind Energy Science (wes)

%% \usepackage commands included in the copernicus.cls:
%\usepackage[german, english]{babel}
%\usepackage{tabularx}
%\usepackage{cancel}
%\usepackage{multirow}
%\usepackage{supertabular}
%\usepackage{algorithmic}
%\usepackage{algorithm}
%\usepackage{amsthm}
%\usepackage{float}
%\usepackage{subfig}
%\usepackage{rotating}

\usepackage[toc, page]{appendix}
\renewcommand{\appendixname}{Anexos}

\begin{document}

\title{"Use of machine learning models for flow rate prediction in the Cautín River through R" \\
Proyecto Final - Informe de Avance 03}

% \Author[affil]{given_name}{surname}

%\Author[][EMAIL]{}{} %% correspondence author
%\Author[]{}{}

%\affil[]{ADDRESS}

\Author[1][r.cano01@ufromail.cl]{Rocío}{Cano Manzano}
\affil[1]{Curso IIO222, 2025-S1, Informe de Avance 03, Equipo 07}

\Author[1]{Gadiel}{Sepúlveda Aguilera}

%% The [] brackets identify the author with the corresponding affiliation. 1, 2, 3, etc. should be inserted.

%% If an author is deceased, please mark the respective author name(s) with a dagger, e.g. "\Author[2,$\dag$]{Anton}{Smith}", and add a further "\affil[$\dag$]{deceased, 1 July 2019}".

%% If authors contributed equally, please mark the respective author names with an asterisk, e.g. "\Author[2,*]{Anton}{Smith}" and "\Author[3,*]{Bradley}{Miller}" and add a further affiliation: "\affil[*]{These authors contributed equally to this work.}".

\runningtitle{TEXT}

\runningauthor{TEXT}

\received{}
\pubdiscuss{} %% only important for two-stage journals
\revised{}
\accepted{}
\published{}

%% These dates will be inserted by Copernicus Publications during the typesetting process.

\firstpage{1}

\maketitle

\begin{abstract}
  River floods have posed an ongoing risk for cities and communities nearby. The Cautín River, on the Araucania Region, Chile, has shown a surge in flood events, affecting particularly vulnerable zones, and future phenomena are expected to cause higher damage due to climate change. Therefore, the devolpment and usage of early warning systems is crucial to reduce their cost and impact. Over the last few years, an increasing amount of resources have been invested on machine learning models for forecasting, which promise accurate results with little computational effort, as research shows. The following work aims to evaluate the accuracy of river flow forecasting on a single gauge at the Cautín catchment area, based on river flow and precipitation information using three different models: xgboost, LSTM and random forests. At the moment of writing, no previous works have studied these models on the aforementioned zone; so the results of this endeavor, once completed, will offer valuable insights for the implementation of early warning systems, thus potentially improving response to future events.
\end{abstract}

%\copyrightstatement{TEXT} %% This section is optional and can be used for copyright transfers.

\introduction[Introducción]  %% \introduction[modified heading if necessary]
\label{sec:Introduction}
%% Esto es solo un ejemplo de como citar textualmente \citet{Beck+al2023} o entre paréntesis \citep{Beck+al2023}

El río Cautín, ubicado en la región de La Araucanía, nace en la falda sur del volcán Lonquimay y fluye hacia el sureste hasta confluir con el río Chol Chol, dando origen al río Imperial \citep{richard_cerda_respuesta_2014}. Con una longitud aproximada de 174 kilómetros, su curso atraviesa las comunas de Curacautín, Lautaro, Vilcún, Padre Las Casas y Temuco, antes de confluir con el río Quepe, lo que evidencia su relevancia tanto geográfica como social.

Este río tiene un régimen pluvial, lo que significa que se alimenta principalmente de agua de lluvia. Así, han sido frecuentes las crecidas e inundaciones que han impactado considerablemente a las comunidades aledañas, y el cambio climático sólo augura un recrudecimiento en estos fenómenos. Según \citet{padilla_turra_registros_2024}, el SENAPRED ha registrado un total de veintiséis emergencias asociadas a crecidas en el Cautín, destacando en junio del 2018 una que finalmente provocó el desplome parcial de un tramo del puente ferroviario que cruzaba el río. Por otra parte, en 2021, \citet{el_mostrador_intendencia_2021} advirtió sobre una alarma emitida por un riesgo de inundación en Temuco y Padre Las Casas; y, dos años después, \citet{mennickent_barros_desbordes_2023} contó que, por un desborde ocurrido en el sector de Rariruca, que une Curacautín con Lautaro, se emitió alerta amarilla en la primera comuna.

Esta situación es de especial preocupación, considerando que en Temuco, por ejemplo, los barrios asociados a la ribera del Cautín son barrios particularmente vulnerables al haberse desarrollado con escasa planificación. \citep{acuna_munoz_volver_2020}. Por lo tanto, surge la necesidad de contar con medidas que permitan responder adecuadamente a estos desastres. En particular, la implementación de sistemas de alerta temprana permite ahorrar hasta diez veces el costo de implementación en pérdidas materiales y humanas. \citep{global_commission_on_adaptation_adapt_nodate}.

El desarrollo de estrategias de manejo de riesgos sostenibles y eficientes bajo condiciones cambiantes requiere comprender los cambios temporales en las causas y efectos de las inundaciones \citep{kreibich_panta_2023}. Así, especialmente en la cuenca a estudiar, es relevante estudiar la incidencia de las precipitaciones sobre el caudal del río. Por otra parte, el avance de la tecnología ha sido tal que realizar predicciones a grandes escalas se ha hecho posible \citep{arnal_towards_2025}. En cuanto a esta materia, existe toda una rama emergente de investigación, donde existen tanto modelos deterministas como probabilísticos. Estos últimos tienen la ventaja de manejar la incertidumbre inherente a estos fenómenos \citep{wakai_historical_2025}.

Dentro de esta última categoría, en los últimos años se dado un énfasis al desarrollo y evaluación de predicciones mediante aprendizaje automático. Cada modelo tiene sus ventajas y desventajas y su aplicabilidad depende de la tarea a resolver y los datos disponibles \citep{fischer_impact_2025}. Citando un caso notable, \citet{luppichini_machine_2024} estudiaron modelos LSTM sobre una cuenca del noroeste de Italia para predecir alturas hidrométricas en una red de estaciones. Los modelos desarrollados ofrecieron predicciones reproducibles, con un bajo costo computacional y errores de unos pocos centímetros. La única observación es que los modelos presentaron una tendencia a subestimar los valores a medida que aumentaba el tiempo de anticipación.

A la fecha de publicación, el presente trabajo propone un enfoque pionero en la Región de la Araucanía al poner a prueba el rendimiento del aprendizaje automático para sistemas de alerta temprana. El objetivo general de este proyecto fue evaluar la precisión de las predicciones de caudal en una estación fluviométrica para diferentes modelos de aprendizaje automático en base a datos de caudal y precipitaciones. Los objetivos específicos fueron:
\begin{itemize}
  \item Entrenar los modelos de aprendizaje automático xgboost, randomforest y LSTM para obtener proyecciones de caudal en base a datos hidrológicos históricos.
  \item Comparar los niveles de caudal predichos por cada modelo con datos históricos en diferentes momentos del sistema.
  \item Implementar una aplicación web que permita la visualización, análisis y descarga de los resultados obtenidos.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Metodología}
\label{sec:Metodologia}

\subsection{Datos utilizados}
La zona estudiada corresponde a la cuenca de Cautín Alto, en la Región de la Araucanía, en Chile. Las estaciones hidrológicas consideradas fueron las estaciones Río Cautín en Cajón, Río Cautín en Rari-Ruca, y Río Blanco en Curacautín, todas dependientes de la Dirección General de Aguas, y cuyas ubicaciones se pueden apreciar en la figura \ref{fig:gauges}.

\begin{figure}[h!]
  \includegraphics{a}
  \caption{Ubicación espacial y tipo de las estaciones consideradas. En azul, se marcan las estaciones de entrada y en rojo, las de salida.}
  \label{fig:gauges}
\end{figure}

Se recogieron las variables de precipitaciones y caudal desde los sitios web \url{} y \url{https://snia.mop.gob.cl/BNAConsultas/reportes}, respectivamente. En ambos casos, se recogieron series temporales con inicio el 1 de enero de 2002 y fin el 31 de diciembre de 2024. Las restricciones impuestas por los mencionados portales obligaron a la descarga de los datos por fragmentos, en periodos de 1 año. La frecuencia de los datos es sub-diaria, con abundantes tramos en frecuencia regular horaria. Esta información se resumen en la Tabla \ref{tab:data}.

\begin{sidewaystable*}
  \begin{tabular}[|l|l|l|l|l|l|l|]
    \hline
    Estación & Organismo & Variable & Inicio & Fin & Frecuencia & Zona horaria\\
    \hline
    Río Cautín en Cajón & DGA & Caudal & 1/1/2002 & 31/12/2024 & subdiaria & UTC -4\\
    \hline
    \caption{Resumen de las principales características de los datos extraídos.}
    \label{tab:data}
  \end{tabular}
\end{sidewaystable*}

\subsection{Modelos a evaluar}

Se escogieron tres modelos de aprendzaje automático para esta evaluación. En primer lugar, el modelo xgboost es una implementación del modelo de descenso de grandiente, desarrollado por Cada uno de estos modelos se describe extensivamente en el anexo \ref{appendix:Anexo A}.

En los tres casos, la variable a obtener,
\subsection{Métricas de error}

El raíz del error cuadrático medio, abreviado como $\mathrm{RMSE}$ por sus siglas en inglés consiste en la raíz cuadrada de la suma de los cuadrados de las diferencias entre valores estimados y valores medidos. Su uso está validado como medición de la precisión de un modelo hidrológico por \citet{luppichini_machine_2024}.

\begin{equation}
  \mathrm{RMSE} = \sqrt{\dfrac{1}{n}\sum_{j=1}^{n} (Y_i-Y_i)^2}
\end{equation}

El Coeficiente de eficiencia de Nash-Sutcliffe, conocido por sus siglas en inglés como NSE, se utiliza para evaluar la eficacia predictiva de un modelo hidrológico. Considerando un total de $T$ observaciones, se calcula como:

\begin{equation}
  \mathrm{NSE} = 1 - \dfrac
  {\sum_{t=1}^T (Q_o^t-Q_m^t)^2}
  {\sum_{t=1}^T (Q_o^t-Q_o)^2}
\end{equation}

donde $Q_o^t$ indica el valor observado al tiempo $t$, $Q_m^t$ indica el valor modelado al tiempo $t$, y $Q_o$ es el promedio de las observaciones. El valor de este coeficiente puede variar entre $-\infty$ y $1$, con $\mathrm{NSE}=1$ siendo el valor óptimo. \citet{melsen_rise_2025} indican que valores entre 0 y 1 se consideran aceptables, mientras que un valor inferior a 1 muestra que el promedio es un mejor predictor que cualquier valor modelado, y, por lo tanto, el modelo no tiene capacidad predictiva.

\subsection{Proceso}
Para llevar a cabo este proyecto, se dividió el flujo de trabajo en cinco grandes etapas: descarga y procesamiento de datos, fusión y partición de datos, entrenamiento de modelos, prueba de modelos, e implementación de la aplicación web.

La primera función se usó para importar los datos. Recibe como entrada una ruta de directorio, donde examina, y, dependiendo del tipo de archivo leído, lee los valores correspondientes.

La segunda función se usó para proesar los datos

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Resultados}
\label{sec:Resultados}

\subsection{Prueba de modelos}

\subsection{Implementación de aplicación web}
Para visualizar y analizar el comportamiento de cada modelo y compararlo con
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\section{Conclusiones}
\label{sec:Conclusiones}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Contribuciones}
\label{Contribuciones}

Rocío Cano Manzano realizó un catastro inicial de los eventos de crecida más relevantes en la Cuenca del Río Cautín durante el siglo XX como inicio de la motivación. Ella también descargó los datos necesarios, programó funciones para la lectura y limpieza de datos y produjo la interfaz de usuario de la aplicación web en Shiny.

Gadiel Sepúlveda Aguilera investigó el estado del arte de la modelación hidrológica y su aplicación a los sistemas de alerta temprana. Él también fue el encargado de programar funciones para el entrenamiento, validación, y prueba de modelos, el análisis del evento extremo de junio de 2018.

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
\break

%\end{thebibliography}

%% Since the Copernicus LaTeX package includes the BibTeX style file copernicus.bst,
%% authors experienced with BibTeX only have to include the following two lines:
%%
\bibliographystyle{copernicus}

\bibliography{Referencias}

%%
%% URLs and DOIs can be entered in your BibTeX file as:
%%
%% URL = {http://www.xyz.org/~jones/idx_g.htm}
%% DOI = {10.5194/xyz}

%% LITERATURE CITATIONS
%%
%% command                        & example result
%% \citet{jones90}|               & Jones et al. (1990)
%% \citep{jones90}|               & (Jones et al., 1990)
%% \citep{jones90,jones93}|       & (Jones et al., 1990, 1993)
%% \citep[p.~32]{jones90}|        & (Jones et al., 1990, p.~32)
%% \citep[e.g.,][]{jones90}|      & (e.g., Jones et al., 1990)
%% \citep[e.g.,][p.~32]{jones90}| & (e.g., Jones et al., 1990, p.~32)
%% \citeauthor{jones90}|          & Jones et al.
%% \citeyear{jones90}|            & 1990

%% FIGURES

%% When figures and tables are placed at the end of the MS (article in one-column style), please add \clearpage
%% between bibliography and first table and/or figure as well as between each table and/or figure.

% The figure files should be labelled correctly with Arabic numerals (e.g. fig01.jpg, fig02.png).

%% ONE-COLUMN FIGURES

%%f
%\begin{figure}[t]
%\includegraphics[width=8.3cm]{FILE NAME}
%\caption{TEXT}
%\end{figure}
%
%%% TWO-COLUMN FIGURES
%
%%f
%\begin{figure*}[t]
%\includegraphics[width=12cm]{FILE NAME}
%\caption{TEXT}
%\end{figure*}
%
%
%%% TABLES
%%%
%%% The different columns must be seperated with a & command and should
%%% end with \\ to identify the column brake.
%
%%% ONE-COLUMN TABLE
%
%%t
%\begin{table}[t]
%\caption{TEXT}
%\begin{tabular}{column = lcr}
%\tophline
%
%\middlehline
%
%\bottomhline
%\end{tabular}
%\belowtable{} % Table Footnotes
%\end{table}
%
%%% TWO-COLUMN TABLE
%
%%t
%\begin{table*}[t]
%\caption{TEXT}
%\begin{tabular}{column = lcr}
%\tophline
%
%\middlehline
%
%\bottomhline
%\end{tabular}
%\belowtable{} % Table Footnotes
%\end{table*}
%
%%% LANDSCAPE TABLE
%
%%t
%\begin{sidewaystable*}[t]
%\caption{TEXT}
%\begin{tabular}{column = lcr}
%\tophline
%
%\middlehline
%
%\bottomhline
%\end{tabular}
%\belowtable{} % Table Footnotes
%\end{sidewaystable*}
%
%
%%% MATHEMATICAL EXPRESSIONS
%
%%% All papers typeset by Copernicus Publications follow the math typesetting regulations
%%% given by the IUPAC Green Book (IUPAC: Quantities, Units and Symbols in Physical Chemistry,
%%% 2nd Edn., Blackwell Science, available at: http://old.iupac.org/publications/books/gbook/green_book_2ed.pdf, 1993).
%%%
%%% Physical quantities/variables are typeset in italic font (t for time, T for Temperature)
%%% Indices which are not defined are typeset in italic font (x, y, z, a, b, c)
%%% Items/objects which are defined are typeset in roman font (Car A, Car B)
%%% Descriptions/specifications which are defined by itself are typeset in roman font (abs, rel, ref, tot, net, ice)
%%% Abbreviations from 2 letters are typeset in roman font (RH, LAI)
%%% Vectors are identified in bold italic font using \vec{x}
%%% Matrices are identified in bold roman font
%%% Multiplication signs are typeset using the LaTeX commands \times (for vector products, grids, and exponential notations) or \cdot
%%% The character * should not be applied as mutliplication sign
%
%
%%% EQUATIONS
%
%%% Single-row equation
%
%\begin{equation}
%
%\end{equation}
%
%%% Multiline equation
%
%\begin{align}
%& 3 + 5 = 8\\
%& 3 + 5 = 8\\
%& 3 + 5 = 8
%\end{align}
%
%
%%% MATRICES
%
%\begin{matrix}
%x & y & z\\
%x & y & z\\
%x & y & z\\
%\end{matrix}
%
%
%%% ALGORITHM
%
%\begin{algorithm}
%\caption{...}
%\label{a1}
%\begin{algorithmic}
%...
%\end{algorithmic}
%\end{algorithm}
%
%
%%% CHEMICAL FORMULAS AND REACTIONS
%
%%% For formulas embedded in the text, please use \chem{}
%
%%% The reaction environment creates labels including the letter R, i.e. (R1), (R2), etc.
%
%\begin{reaction}
%%% \rightarrow should be used for normal (one-way) chemical reactions
%%% \rightleftharpoons should be used for equilibria
%%% \leftrightarrow should be used for resonance structures
%\end{reaction}
%
%
%%% PHYSICAL UNITS
%%%
%%% Please use \unit{} and apply the exponential notation
\begin{appendices}
  \section{Anexo A}
  \label{appendix:Anexo A}

\end{appendices}

\end{document}
